<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Insert title here</title>
</head>
<body>
</body>
<script>
/*
 *  7.  함수형 프로그래밍
 *  7.2 자바스크립트에서의 함수형 프로그래밍
 *  7-1 
 */

console.log("7-1");
var f1 = function(input){
	var result;
	/* 암호화 작업 수행*/
	result = 1;
	return result;
}

var f2 = function(input){
	var result;
	/* 암호화 작업 수행*/
	result = 2;
	return result;
}

var f3 = function(input){
	var result;
	/* 암호화 작업 수행*/
	result = 3;
	return result;
}

var get_encrypted = function(func){
	var str = 'zzoon';
	
	return function(){
		return func.call(null,str);
	}
}

var encrypted_value = get_encrypted(f1)();
console.log(encrypted_value);


var encrypted_value = get_encrypted(f2)();
console.log(encrypted_value);


var encrypted_value = get_encrypted(f3)();
console.log(encrypted_value);


/*
 * 7.2.1 배열의 각 원소 총합 구하기
 * 7-2-1
 */
console.log("7-2-1");
function sum(arr){
	var len = arr.length;
	var i = 0,sum = 0;
	
	for(;i < len; i++){
		sum += arr[i];
	}
	return sum;
}

var arr = [1,2,3,4];
console.log(sum(arr));


/*
 * 7-2-2
 */
 
console.log("7-2-2");
function multiply(arr){
	var len = arr.length;
	var i = 0,result = 1;
	
	for(;i < len; i++){
		result *= arr[i];
	}
	return result;
}

var arr = [1,2,3,4];
console.log(multiply(arr));


/*
 * 7-2-3
 */
 
console.log("7-2-3");
function reduce(func, arr, memo) {
	var len = arr.length,
		i = 0,
		accum = memo;

	for (; i < len; i++) {
		accum = func(accum, arr[i]);
	}
	return accum;
}

function reduce(func, arr, memo) {
	var len = arr.length,
		i = 0,
		accum = memo;

	for (; i < len; i++) {
		accum = func(accum, arr[i]);
	}

	return accum;
}

var arr = [ 1, 2, 3, 4 ];

var sum2 = function(x, y) {
	return x+y;
};

var multiply2 = function(x, y) {
	return x*y;
};

console.log(reduce(sum2, arr, 0));
console.log(reduce(multiply2, arr, 1));


/*
 * 7.2.2 팩토리얼
 * 7-3-1 
 */
console.log("7-3-1");
function fact(num){
	var val = 1;
	for(var i=2 ;i<=num ;i++){
		val = val * i;
	}
	return val;
}

console.log(fact(100));

/*
 * 7-3-2 재귀호출법
 */
console.log("7-3-2");
function fact2(num){
	if(num == 0)return 1;
	else return num * fact2(num-1);
}
console.log(fact2(100));


/*
 * 7-3-3
 */
console.log("7-3-3");
var fact = function() {
	var cache = {'0' : 1};
	var func = function(n) {
		var result = 0;
		if (typeof(cache[n]) === 'number') {
			result = cache[n];
		} else {
			result = cache[n] = n * func(n-1);
			console.log("cache["+n+"]"+cache[n]);
		}
		return result;
	}

	return func;
}();

console.log(fact(10));
console.log(fact(20));


/*
 * 7.2.3 피보나치 수열
 * 7-4
 */

 console.log("7-4");
 var fibo = function(){
	var cache = {'0':0,'1',1};
	
	var func = function(n){
		if(typeof(cache[n]) === 'number'){
			result = cache[n];
		}else{
			result = cache[n] = func(n-1) + func(n-2);
		}
		return result;
	}
	return func;
}();

console.log(fibo(10));


/*
 * 7-5
 */
 console.log("7-5");
var cacher = function(cache, func) {
	var calculate = function(n) {
		if (typeof(cache[n]) === 'number') {
			result = cache[n];
		} else {
			result = cache[n] = func(calculate, n);
		}

		return result;
	}
	
	return calculate;
};

var cacher = function(cache, func) {
	var calculate = function(n) {
		if (typeof(cache[n]) === 'number') {
			result = cache[n];
		} else {
			result = cache[n] = func(calculate, n);
		}

		return result;
	}
	
	return calculate;
};

var fact4 = cacher({ '0':1 }, function(func, n) {
	return n * func(n-1);
});

var fibo4 = cacher({ '0':0, '1':1 }, function(func, n) {
	return func(n-1) + func(n-2);
});

console.log(fact4(10));
console.log(fibo4(10));



</script>
</html>